# file generated by template ffizer (keys are sorted alphabetically)

jobs:
  bake:
    needs:
    - test_build
    - devcontainer
    secrets: inherit
    uses: uberforcede/wefox-ai-wai-templates/.github/workflows/_bake.v4.yml@master
    with:
      APP_NAME: ${{ github.event.repository.name }}
      APP_TARGET_VALUES: '[("ms", "devops/chart-ms/values.yaml")]'
      AWS_ACCOUNT_ID: ${{ vars.AWS_ACCOUNT_ID }}
      DEVCONTAINER: ${{ needs.devcontainer.outputs.image_full_name }}
      TAG_FOR_DEPLOY_TO_DEV: true
  devcontainer:
    secrets: inherit
    uses: uberforcede/wefox-ai-wai-templates/.github/workflows/_build_devcontainer.v1.yml@master
    with:
      APP_NAME: ${{ github.event.repository.name }}
      AWS_ACCOUNT_ID: ${{ vars.AWS_ACCOUNT_ID }}
  test_build:
    needs:
    - devcontainer
    secrets: inherit
    uses: uberforcede/wefox-ai-wai-templates/.github/workflows/_test_build_rust.v2.yml@master
    with:
      APP_NAME: ${{ github.event.repository.name }}
      AWS_ACCOUNT_ID: ${{ vars.AWS_ACCOUNT_ID }}
      DEVCONTAINER: ${{ needs.devcontainer.outputs.image_full_name }}
name: ci
on:
  push:
    branches:
    - '**'
    paths-ignore:
    - devops/chart*/values*
    - devops/Dockerfile
    - devops/argo-workflow/*.yaml
  workflow_dispatch: null
permissions:
  actions: read
  contents: read
  id-token: write
